<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Moderated Nonlinear Factor Analysis — mnlfa • mnlfa</title>

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- sticky kit -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Moderated Nonlinear Factor Analysis — mnlfa" />

<meta property="og:description" content="General function for conducting moderated nonlinear factor analysis
(Curran et al., 2014). Item slopes and item intercepts can be modeled as functions
of person covariates.
Parameter regularization is allowed. For categorical covariates,
group lasso can be used for regularization." />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">mnlfa</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Versions">0.2-vv</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/alexanderrobitzsch/mnlfa">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Moderated Nonlinear Factor Analysis</h1>
    
    <div class="hidden name"><code>mnlfa.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>General function for conducting moderated nonlinear factor analysis
(Curran et al., 2014). Item slopes and item intercepts can be modeled as functions
of person covariates.</p>
<p>Parameter regularization is allowed. For categorical covariates,
group lasso can be used for regularization.</p>
    
    </div>

    <pre class="usage">mnlfa(dat, items, item_type="2PL", formula_int=~1, formula_slo=~1, formula_mean=~0,
   formula_sd=~0, theta=NULL, parm_list_init=NULL, parm_trait_init=NULL, prior_init=NULL,
   regular_lam=c(0, 0), regular_type=c("none", "none"), maxit=1000, msteps=4, conv=1e-05,
   conv_mstep=1e-04, h=1e-04, parms_regular_types=NULL, parms_regular_lam=NULL,
   parms_iterations=NULL, center_parms=NULL, center_max_iter=6, L_max=.07,
   verbose=TRUE)

# S3 method for mnlfa
summary(object, file=NULL, &#8230;)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>dat</th>
      <td><p>Data frame with item responses</p></td>
    </tr>
    <tr>
      <th>items</th>
      <td><p>Vector containing item names</p></td>
    </tr>
    <tr>
      <th>item_type</th>
      <td><p>String or vector of item types. Currently, only item types <code>"1PL"</code> or
<code>"2PL"</code> can be chosen.</p></td>
    </tr>
    <tr>
      <th>formula_int</th>
      <td><p>String or list with formula for item intercepts</p></td>
    </tr>
    <tr>
      <th>formula_slo</th>
      <td><p>String or list with formula for item slopes</p></td>
    </tr>
    <tr>
      <th>formula_mean</th>
      <td><p>Formula for mean of the trait distribution</p></td>
    </tr>
    <tr>
      <th>formula_sd</th>
      <td><p>Formula for standard deviation of the trait distribution</p></td>
    </tr>
    <tr>
      <th>theta</th>
      <td><p>Grid of \(\theta\) values used for approximation of normally
distributed trait</p></td>
    </tr>
    <tr>
      <th>parm_list_init</th>
      <td><p>Optional list of initial item parameters</p></td>
    </tr>
    <tr>
      <th>parm_trait_init</th>
      <td><p>Optional list of initial parameters for trait distribution</p></td>
    </tr>
    <tr>
      <th>prior_init</th>
      <td><p>Optional matrix of prior distribution for persons</p></td>
    </tr>
    <tr>
      <th>regular_lam</th>
      <td><p>Vector of length two containing two general regularization
parameters for item intercepts and item slopes</p></td>
    </tr>
    <tr>
      <th>regular_type</th>
      <td><p>Type of regularization method. Can be <code>"none"</code>,
<code>"lasso"</code>, <code>"scad"</code> or <code>"mcp"</code>.</p></td>
    </tr>
    <tr>
      <th>maxit</th>
      <td><p>Maximum number of iterations</p></td>
    </tr>
    <tr>
      <th>msteps</th>
      <td><p>Maximum number of M-steps</p></td>
    </tr>
    <tr>
      <th>conv</th>
      <td><p>Convergence criterion with respect to parameters</p></td>
    </tr>
    <tr>
      <th>conv_mstep</th>
      <td><p>Convergence criterion in M-step</p></td>
    </tr>
    <tr>
      <th>h</th>
      <td><p>Numerical differentiation parameter</p></td>
    </tr>
    <tr>
      <th>parms_regular_types</th>
      <td><p>Optional list containing parameter specific regularization types</p></td>
    </tr>
    <tr>
      <th>parms_regular_lam</th>
      <td><p>Optional list containing parameter specific regularization parameters</p></td>
    </tr>
    <tr>
      <th>parms_iterations</th>
      <td><p>Optional list containing sequence of parameter indices used for updating</p></td>
    </tr>
    <tr>
      <th>center_parms</th>
      <td><p>Optional list indicating which parameters
should be centered during initial iterations.</p></td>
    </tr>
    <tr>
      <th>center_max_iter</th>
      <td><p>Maximum number of iterations in which parameters
  should be centered.</p></td>
    </tr>
    <tr>
      <th>L_max</th>
      <td><p>Majorization parameter used in regularization</p></td>
    </tr>
    <tr>
      <th>verbose</th>
      <td><p>Logical indicating whether output should be printed</p></td>
    </tr>
    <tr>
      <th>object</th>
      <td><p>Object of class <code>mnlfa</code></p></td>
    </tr>
    <tr>
      <th>file</th>
      <td><p>Optional file name</p></td>
    </tr>
    <tr>
      <th>&#8230;</th>
      <td><p>Further arguments to be passed</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The moderated factor analysis model for dichotomous responses defined as
$$P(X_{pi}=1 | \theta_p )=invlogit( a_{pi} \theta_p - b_{pi} ) $$
The trait distribution \(\theta_p \sim N( \mu_p, \sigma_p^2)\)
allows a latent regression of person covariates on the mean
with \(\mu_p=\bold{X}_p \bold{\gamma}\) (to be specified in <code>formula_mean</code>)
and the logarithm of the standard deviation \(\log \sigma_p=\bold{Z}_p \bold{\delta} \)
(to be specified in <code>formula_sd</code>).
Item intercepts and item slopes can be moderated by person covariates, i.e.
\(a_{pi}=\bold{W}_{pi} \bold{\alpha}_i \) and
\(b_{pi}=\bold{V}_{pi} \bold{\beta}_i \). Regularization on (some of) the
\(\bold{\alpha}_i\) or \(\bold{\beta}_i\) parameters is allowed.</p>
<p>The model is estimated using an EM algorithm with the coordinate descent
method during the M-step (Sun et al., 2016).</p>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>List with model results including</p>
<dt>item</dt><dd><p>Summary table for item parameters</p></dd>
<dt>trait</dt><dd><p>Summary table for trait parameters</p></dd>

    
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Curran, P. J., McGinley, J. S., Bauer, D. J., Hussong, A. M., Burns, A.,
Chassin, L., Sher, K., &amp; Zucker, R. (2014).
A moderated nonlinear factor model for the development of commensurate measures
in integrative data analysis. <em>Multivariate Behavioral Research, 49</em>(3),
214-231.
http://dx.doi.org/10.1080/00273171.2014.889594</p>
<p>Sun, J., Chen, Y., Liu, J., Ying, Z., &amp; Xin, T. (2016). Latent variable selection for 
multidimensional item response theory models via L1 regularization. 
<em>Psychometrika, 81</em>(4), 921-939.
 https://doi.org/10.1007/s11336-016-9529-6</p>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p>See also the <span class="pkg">aMNLFA</span> package for automatized moderated nonlinear factor analysis
which provides convenient wrapper functions for automized analysis
in the <em>Mplus</em> software.</p>
<p>See the <span class="pkg">GPCMlasso</span> package for the regularized generalized partial credit model.</p></div>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><span class='co'># NOT RUN {</span>
<span class='co'>#############################################################################</span>
<span class='co'># EXAMPLE 1: Dichotomous data, 1PL model</span>
<span class='co'>#############################################################################</span>

<span class='fu'><a href='https://www.rdocumentation.org/packages/utils/topics/data'>data</a></span>(<span class='no'>data.mnlfa01</span>, <span class='kw'>package</span><span class='kw'>=</span><span class='st'>"mnlfa"</span>)

<span class='no'>dat</span> <span class='kw'>&lt;-</span> <span class='no'>data.mnlfa01</span>
<span class='co'># extract items from dataset</span>
<span class='no'>items</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/grep'>grep</a></span>(<span class='st'>"I[0-9]"</span>, <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/colnames'>colnames</a></span>(<span class='no'>dat</span>), <span class='kw'>value</span><span class='kw'>=</span><span class='fl'>TRUE</span>)
<span class='no'>I</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/length'>length</a></span>(<span class='no'>items</span>)

<span class='co'># maximum number of iterations (use only few iterations for the only purpose of</span>
<span class='co'># providing CRAN checks)</span>
<span class='no'>maxit</span> <span class='kw'>&lt;-</span> <span class='fl'>10</span>

<span class='co'>#***** Model 1: 1PL model without moderating parameters and without covariates for traits</span>

<span class='co'># no covariates for trait</span>
<span class='no'>formula_mean</span> <span class='kw'>&lt;-</span> ~<span class='fl'>0</span>
<span class='no'>formula_sd</span> <span class='kw'>&lt;-</span> ~<span class='fl'>1</span>
<span class='co'># no item covariates</span>
<span class='no'>formula_int</span> <span class='kw'>&lt;-</span> ~<span class='fl'>1</span>
<span class='no'>formula_slo</span> <span class='kw'>&lt;-</span> ~<span class='fl'>1</span>

<span class='no'>mod1</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>mnlfa</span><span class='kw ns'>::</span><span class='fu'><a href='https://www.rdocumentation.org/packages/mnlfa/topics/mnlfa'>mnlfa</a></span>( <span class='kw'>dat</span><span class='kw'>=</span><span class='no'>dat</span>, <span class='no'>items</span>, <span class='kw'>item_type</span><span class='kw'>=</span><span class='st'>"1PL"</span>, <span class='kw'>formula_int</span><span class='kw'>=</span><span class='no'>formula_int</span>,
             <span class='kw'>formula_slo</span><span class='kw'>=</span><span class='no'>formula_slo</span>, <span class='kw'>formula_mean</span><span class='kw'>=</span><span class='no'>formula_mean</span>, <span class='kw'>formula_sd</span><span class='kw'>=</span><span class='no'>formula_sd</span>,
             <span class='kw'>maxit</span><span class='kw'>=</span><span class='no'>maxit</span> )
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/summary'>summary</a></span>(<span class='no'>mod1</span>)

<span class='co'># }</span><span class='co'># NOT RUN {</span>
<span class='co'>#***** Model 2: 1PL model without moderating parameters and with covariates for traits</span>

<span class='co'># covariates for trait</span>
<span class='no'>formula_mean</span> <span class='kw'>&lt;-</span> ~<span class='no'>female</span> + <span class='no'>age</span>
<span class='no'>formula_sd</span> <span class='kw'>&lt;-</span> ~<span class='fl'>1</span>

<span class='no'>mod2</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>mnlfa</span><span class='kw ns'>::</span><span class='fu'><a href='https://www.rdocumentation.org/packages/mnlfa/topics/mnlfa'>mnlfa</a></span>( <span class='kw'>dat</span><span class='kw'>=</span><span class='no'>dat</span>, <span class='no'>items</span>, <span class='kw'>item_type</span><span class='kw'>=</span><span class='st'>"1PL"</span>, <span class='kw'>formula_int</span><span class='kw'>=</span><span class='no'>formula_int</span>,
             <span class='kw'>formula_slo</span><span class='kw'>=</span><span class='no'>formula_slo</span>, <span class='kw'>formula_mean</span><span class='kw'>=</span><span class='no'>formula_mean</span>, <span class='kw'>formula_sd</span><span class='kw'>=</span><span class='no'>formula_sd</span>)
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/summary'>summary</a></span>(<span class='no'>mod2</span>)

<span class='co'>#***** Model 3: 1PL model with moderating parameters and with covariates for traits</span>
<span class='co'>#***   Regularization method 'mcp'</span>

<span class='co'># covariates for trait</span>
<span class='no'>formula_mean</span> <span class='kw'>&lt;-</span> ~<span class='no'>female</span> + <span class='no'>age</span>
<span class='no'>formula_sd</span> <span class='kw'>&lt;-</span> ~<span class='fl'>1</span>
<span class='co'># moderation effects for items</span>
<span class='no'>formula_int</span> <span class='kw'>&lt;-</span> ~<span class='fl'>1</span>+<span class='no'>female</span>+<span class='no'>age</span>
<span class='no'>formula_slo</span> <span class='kw'>&lt;-</span> ~<span class='fl'>1</span>

<span class='co'># center parameters for female and age in initial iterations for improving convergence</span>
<span class='no'>center_parms</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/list'>list</a></span>( <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/rep'>rep</a></span>(<span class='fl'>2</span>,<span class='no'>I</span>), <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/rep'>rep</a></span>(<span class='fl'>3</span>,<span class='no'>I</span>) )

<span class='co'># regularization parameters for item intercept and item slope, respectively</span>
<span class='no'>regular_lam</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='fl'>.06</span>, <span class='fl'>.25</span>)
<span class='no'>regular_type</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='st'>"mcp"</span>,<span class='st'>"none"</span>)

<span class='no'>mod3</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>mnlfa</span><span class='kw ns'>::</span><span class='fu'><a href='https://www.rdocumentation.org/packages/mnlfa/topics/mnlfa'>mnlfa</a></span>( <span class='kw'>dat</span><span class='kw'>=</span><span class='no'>dat</span>, <span class='no'>items</span>, <span class='kw'>item_type</span><span class='kw'>=</span><span class='st'>"1PL"</span>, <span class='kw'>formula_int</span><span class='kw'>=</span><span class='no'>formula_int</span>,
            <span class='kw'>formula_slo</span><span class='kw'>=</span><span class='no'>formula_slo</span>, <span class='kw'>formula_mean</span><span class='kw'>=</span><span class='no'>formula_mean</span>, <span class='kw'>formula_sd</span><span class='kw'>=</span><span class='no'>formula_sd</span>,
            <span class='kw'>center_parms</span><span class='kw'>=</span><span class='no'>center_parms</span>, <span class='kw'>regular_lam</span><span class='kw'>=</span><span class='no'>regular_lam</span>, <span class='kw'>regular_type</span><span class='kw'>=</span><span class='no'>regular_type</span> )
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/summary'>summary</a></span>(<span class='no'>mod3</span>)


<span class='co'>#***** Model 4: 1PL model with selected moderated item parameters</span>

<span class='co'>#* trait distribution</span>
<span class='no'>formula_mean</span> <span class='kw'>&lt;-</span> ~<span class='fl'>0</span>+<span class='no'>female</span>+<span class='no'>age</span>
<span class='no'>formula_sd</span> <span class='kw'>&lt;-</span> ~<span class='fl'>1</span>

<span class='co'>#* formulas for item intercepts</span>
<span class='no'>formula_int</span> <span class='kw'>&lt;-</span> ~<span class='fl'>1</span>
<span class='no'>formula_int</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>mnlfa</span><span class='kw ns'>::</span><span class='fu'><a href='https://www.rdocumentation.org/packages/mnlfa/topics/mnlfa_expand_to_list'>mnlfa_expand_to_list</a></span>(<span class='kw'>x</span><span class='kw'>=</span><span class='no'>formula_int</span>, <span class='kw'>names_list</span><span class='kw'>=</span><span class='no'>items</span>)
<span class='no'>mod_items</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='fl'>4</span>,<span class='fl'>5</span>,<span class='fl'>6</span>,<span class='fl'>7</span>)
<span class='kw'>for</span> (<span class='no'>ii</span> <span class='kw'>in</span> <span class='no'>mod_items</span>){
    <span class='no'>formula_int</span><span class='kw'>[[</span><span class='no'>ii</span>]] <span class='kw'>&lt;-</span> ~<span class='fl'>1</span>+<span class='no'>female</span>+<span class='no'>age</span>
}
<span class='no'>formula_slo</span> <span class='kw'>&lt;-</span> ~<span class='fl'>1</span>

<span class='no'>mod4</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>mnlfa</span><span class='kw ns'>::</span><span class='fu'><a href='https://www.rdocumentation.org/packages/mnlfa/topics/mnlfa'>mnlfa</a></span>( <span class='kw'>dat</span><span class='kw'>=</span><span class='no'>dat</span>, <span class='no'>items</span>, <span class='kw'>item_type</span><span class='kw'>=</span><span class='st'>"1PL"</span>, <span class='kw'>formula_int</span><span class='kw'>=</span><span class='no'>formula_int</span>,
              <span class='kw'>formula_slo</span><span class='kw'>=</span><span class='no'>formula_slo</span>, <span class='kw'>formula_mean</span><span class='kw'>=</span><span class='no'>formula_mean</span>, <span class='kw'>formula_sd</span><span class='kw'>=</span><span class='no'>formula_sd</span>)
<span class='no'>mod4</span>$<span class='no'>item</span>
<span class='no'>mod4</span>$<span class='no'>trait</span>
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/summary'>summary</a></span>(<span class='no'>mod4</span>)
<span class='co'># }</span></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#details">Details</a></li>

      <li><a href="#value">Value</a></li>

      <li><a href="#references">References</a></li>

      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Alexander Robitzsch.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
   </div>

  

  </body>
</html>

